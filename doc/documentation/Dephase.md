# Dephase.py

## Overview
This script calculates dephasing time, which is crucial for understanding quantum decoherence in molecular dynamic simulations. It processes energy data, computes autocorrelation functions (ACF), dephasing functions, and their Fourier transforms to analyze phonon influence spectrum. The script is based on the formula described in Jaeger, Fischer, and Prezhdo's work on decoherence-induced surface hopping (JCP 137.22 (2012): 22A545).

## Key Components
- **`gaussian(x, c)`**: A function that returns a Gaussian distribution. Used for fitting the dephasing function.
- **`dephase(Et, dt=1.0)`**: The core function that calculates the ACF, dephasing function (D(t)), and the Fourier Transform of the normalized ACF (I(w)).
    - `Et`: An array of energy differences (in eV) over time.
    - `dt`: Time step (in fs) for the integration.
    - Returns `Ct` (ACF), `Dt` (dephasing function), and `Iw` (phonon influence spectrum).

## Important Variables/Constants
- **`hbar`**: Planck's constant in eV*fs (0.6582119513926019 eV fs). Used in the calculation of the dephasing function.
- **`energy.dat`**: Input file expected by the script. It should contain a matrix where each column represents energy levels of a state, and each row represents a time step.
- **`DEPHTIME`**: Output file generated by the script. It contains a matrix of dephasing times (in fs) between different states.
- **`dt`**: Time step in femtoseconds, hardcoded to `1.0` in the main script execution block but is a parameter for the `dephase` function.

## Usage Examples
The script is typically run from the command line:
```bash
python Dephase.py
```
It expects a file named `energy.dat` to be present in the same directory. The output will be saved in `DEPHTIME`.

The `dephase` function can also be used imported and used in other Python scripts:
```python
import numpy as np
from Dephase import dephase

# Example energy differences time series
energy_differences = np.randomrand(1000)
time_step = 0.5  # fs

Ct, Dt, Iw = dephase(energy_differences, dt=time_step)

print("Autocorrelation Function:", Ct)
print("Dephasing Function:", Dt)
print("Phonon Influence Spectrum:", Iw)
```

## Dependencies and Interactions
- **NumPy**: Used for numerical operations, especially array manipulations (`np.asarray`, `np.average`, `np.correlate`, `np.loadtxt`, `np.savetxt`, `np.zeros`).
- **SciPy**:
    - `scipy.interpolate.interp1d`: Though commented out in the main script block, it's imported and suggests potential use for interpolation.
    - `scipy.optimize.curve_fit`: Used to fit the dephasing function to a Gaussian.
    - `scipy.integrate.cumtrapz`: Used for cumulative integration to calculate G(t).
    - `scipy.fftpack.fft`: Used to calculate the Fourier Transform of the ACF.
- **Matplotlib**: (Commented out in the provided script) Used for plotting results like energy differences, ACF, and dephasing functions.
- **Input File**: `energy.dat` is a critical input. The script reads energy trajectories from this file.
- **Output File**: `DEPHTIME` is the primary output, containing the calculated dephasing times.
```
